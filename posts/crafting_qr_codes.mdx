---
posted: 2024-9-12
desc: How they work and how to make them pretty
image: crafting.jpg
---

import { Sa } from "../components/mdx"
import init from "fuqr"
import { QrTutorial } from "../components/QrTutorial"

QR codes have invaded our world.

Their prolific penetration is no surprise. They store information efficiently, scan fast and reliably, and now that QR code scanning capabilities are built-in on phone cameras, there is nothing that even comes close to their convenience.

They are simply irreplaceable to *anyone looking to share a URL* (read: everyone).

Suffice it to say, I've seen a few QR codes in my day to day.

{
<div className="grid rows-[min-content_1fr_min-content] cols-2 grid-flow-col gap-x-4 font-thin text-xs text-center">
  <div className="font-semibold text-lg">Me Writing this Blog Post</div>
  <img src="train_escape.jpg" alt="me escaping from a train full of salarymen with qr code faces"/>
  <span>
  <Sa href="https://www.flickr.com/photos/19736899@N04/2046534730">Original photo</Sa> by <Sa href="https://www.flickr.com/people/hern42/">Arnaud DG</Sa>, <Sa href="https://creativecommons.org/licenses/by/2.0/deed.en">CC BY 2.0</Sa>
  </span>
  <div className="font-semibold text-lg">The Observable Universe</div>
  <img src="rush_hour.jpg" alt="rush hour in train station where salarymen have qr code faces"/>
  <span>
    <Sa href="https://commons.wikimedia.org/wiki/File:Just_going_to_work_(3509126762).jpg">Original photo</Sa> by <Sa href="https://www.flickr.com/people/erikjohansson78/">erikjohansson</Sa>, <Sa href="https://creativecommons.org/licenses/by/2.0/deed.en">CC BY 2.0</Sa>
  </span>
</div>
}

With how widespread they are in consumer facing spaces like advertising, it's also no suprise that companies would want to brand their QR codes. The most common practice is placing a logo in the center, which relies on error correction to recover the missing data. 

{
  <div className="grid cols-2 sm:cols-4 gap-2">
    <img src="logo/in_mcdonalds.jpg" alt="mcdonalds app"/>
    <img src="logo/sf_uber.jpg" alt="uber ad"/>
    <img src="logo/duolingo.jpg" alt="duolingo profile"/>
    <img src="logo/instagram.svg" alt="instagram profile"/>
  </div>
}

Beyond simply placing a logo on top, there have been many attempts to create "artistic" QR codes. Creating images is a popular goal, whether by manipulating the appearance of pixels, darkening and lightening portions of the image, or some combination of techniques.

{
  <div className="grid cols-2 sm:cols-4 gap-2 font-thin text-xs text-center pixelated">
    <div>
      <img src="image/qart_go.png" alt="golang mascot qart code"/>
      <Sa href="https://research.swtch.com/qart">QArt Codes</Sa>
    </div>
    <div>
      <img src="image/halftone_einstein.png" alt="halftone einstein qr code"/>
      <Sa href="https://cgv.cs.nthu.edu.tw/projects/Recreational_Graphics/Halftone_QRCodes">Halftone QR Codes, 2013</Sa>
    </div>
    <div>
      <img src="image/bad_apple.jpg" alt="bad apple video qr code"/>
      <Sa href="https://www.youtube.com/watch?v=tPYUdjptMpk">Bad Apple but it is played with QR code</Sa>
    </div>
    <div>
      <img src="image/overlay_burger_king.jpg" alt="burger king ad qr code"/>
      <Sa href="https://www.youtube.com/watch?v=hnYXq1oyi2g">Burger King VMA Commercials</Sa>
    </div>
  </div>
}

While perhaps limited in stylistic range, these QR codes are trivial to make and the input image can easily be edited. This is in stark contrast to the labor intensive but fully bespoke QR codes made by human designers.

{
  <div className="grid cols-2 sm:cols-4 gap-2 font-thin text-xs text-center pixelated">
    <div>
      <img src="bespoke/qrcanvas.jpg" alt="qrcanvas"/>
      <Sa href="https://qrcanvas.nl">QRcanvas</Sa>
    </div>
    <div>
      <img src="bespoke/amicollective.png" alt="amicollective"/>
      <Sa href="https://www.behance.net/gallery/3702490/CALENDAR">2012 MTS Calendar</Sa> <span className="whitespace-pre">Am I Collective</span> (<Sa href="https://thedsgnblog.tumblr.com/post/32805738545/am-i-collective-httpamicollectivecom">source</Sa>)
    </div>
    <div>
      <img src="bespoke/minor.png" alt="minor"/>
      minor<br/>
      (<Sa href="https://dribbble.com/minorart/shots">Dribbble</Sa>, <Sa href="https://www.behance.net/739019620c2bc">Behance</Sa>)
    </div>
    <div>
      <img src="bespoke/elkoy.png" alt="elkoy artists collective"/>
      <Sa href="https://art-qrcode.com/">The Art of QR Codes / <span className="whitespace-pre">Elkoy Artists</span> Collective</Sa>
    </div>
  </div>
}

{
  <small className="text-stone-700">
    There are many innovative Chinese examples, but I disagree with them aesthetically. I recommend using Pinterest to find them; they are impossible to find otherwise.
  </small>
}

Of course, we musn't neglect to beat the dead elephant in this room, generative AI. The demos are impressive, and with carefully engineered prompts the results appear good. But I've no prompting expertise, so I generated naught but nightmares.

{
  <div className="mx-auto -indent-2 text-sm leading-loose font-serif">
    <p className="ml-2">I shall not beleaguer thy weary eyes,</p>
    <p className="ml-2">nor further burden the web, world wide,</p>
    <p className="ml-2">with pages from this Babelian picture tome.</p>
    <p className="ml-2">This is not a place of honor,</p>
    <p className="ml-2"><em>there are thirteen fingers on her,</em></p>
    <p className="ml-2">anime girl big boobs ancient rome.</p>
  </div>
}

[QRBTF](https://qrbtf.com) was created by the inventors of AI QR codes, but they originally created these parameterized styles which blew my mind.

{
  <div className="grid cols-2 gap-2 font-thin text-xs text-center">
    <div>
      <img src="qrbtf/sp1.svg" alt="blocky design"/>
      Created using <Sa href="https://qrbtf.com">QRBTF</Sa>
    </div>
    <div>
      <img src="qrbtf/sp2.svg" alt="bubble design"/>
      Created using <Sa href="https://qrbtf.com">QRBTF</Sa>
    </div>
  </div>
}

I find these way more interesting, and I gave a go at making my own QR code generator.

{
  <div className="grid cols-2 sm:cols-4 gap-2">
    <img src="qrframe/stained_glass.svg" alt="stained glass"/>
    <img src="qrframe/quantum.svg" alt="physics"/>
    <img src="qrframe/whiteboard.png" alt="whiteboard marker"/>
    <img src="qrframe/neon.svg" alt="neon sign"/>
    <img src="qrframe/layers.svg" alt="layered patterns"/>
    <img src="qrframe/tile.png" alt="bathroom tile"/>
    <img src="qrframe/dots.svg" alt="benday dots"/>
    <img src="qrframe/mondrian.svg" alt="abstract art"/>
  </div>
}

The end result is https://qrframe.kylezhe.ng, which comes with presets inspired by patterns from the world around us and the techniques mentioned above. Here's the [source code](https://github.com/zhengkyl/qrframe) for the perverts.

The main feature is that you can freely create new presets or modify existing ones. It's all just code that generates an SVG or renders to an HTML canvas.

Feel free to play with it, but in order to craft QR codes with intention, we need to learn how they work.

## Anatomy of a QR Code

<QrTutorial/>

A few years ago, I had the idea to draw QR codes using chalk and a stencil.

{
  <div className="grid cols-2 gap-4 font-thin text-xs text-center">
    <div>
      <img src="stencil_1.jpg" alt="bad qr code stencil"/>
      My terrible first attempt
    </div>
    <div>
      <img src="stencil_2.jpg" alt="slightly better qr code stencil"/>
      Improved but still nearly unscannable
    </div>
  </div>
}

This turned out to be impractical, but the biggest issue was that the end result couldn't be scanned *by the default camera app*.

The tradeoff with no longer using 3rd party scanners is that smartphone camera apps are much less aggressive at detecting or attempting to scan codes.

In my experience, the key is **solid colors** and **high contrast**, and my chalk didn't contrast enough against or completely cover the gray concrete.

For QR codes with a lot of "texture", moving farther away can help, but that is the exact opposite response people have to a code not scanning.

## Prior work

The part where it turns a camera image into a grid of binary pixels, 

Basically, if a space is dark enough or light enough, it will be decoded properly.

One strategy, possibly popularized by the [Halftone QR Codes](https://cgv.cs.nthu.edu.tw/projects/Recreational_Graphics/Halftone_QRCodes) paper, involves replacing each QR code pixel with a 3x3 grid of pixels that best match the image while still decoding as the correct color.

{
  <div className="grid cols-2 sm:cols-4 gap-2 font-thin text-xs text-center pixelated">
    <div>
      <img src="halftone.png" alt="halftone mike wazowski qr code"/>
      Created using <Sa href="https://cgv.cs.nthu.edu.tw/projects/Recreational_Graphics/Halftone_QRCodes"><span className="whitespace-pre">Halftone QR Codes, 2013</span></Sa>
    </div>
    <div>
      <img src="amzqr_mike.jpg" alt="color image qr code"/>
      Created using <Sa href="https://github.com/x-hw/amazing-qr">Amazing-QR</Sa>
    </div>
    <div>
      <img src="visualead_mike.jpg" alt="visualead qr code"/>
      Created using <Sa href="https://github.com/x-hw/amazing-qr">Visualead</Sa>
    </div>
    <div>
      <img src="qrpicture.jpg" alt="mike wazowski qr picture"/>
      Created using <Sa href="https://qrpicture.com">QRpicture</Sa>
    </div>
  </div>
}

Generally, as long as the center of each QR code pixel is correct, it can be decoded correctly. In other words, this approach is basically equivalent to overlaying the correct center pixels on top of a image. 

The low resolution black and white dithered effect is just a smart stylistic choice that hides the data as noise. There are many implementations online [^1] as well as a version of [Bad Apple](https://www.youtube.com/watch?v=tPYUdjptMpk).


{
  <div className="grid cols-2 sm:cols-4 pixelated">
    <p className="col-span-2">
      Other methods are available such as adjusting the input URL as in <a href="https://research.swtch.com/qr/draw">QArt Codes</a> and creating word clouds like in <a href="https://cgv.cs.nthu.edu.tw/projects/Recreational_Graphics/MQRC">Micrography QR Codes</a>. These are quite niche, but full of good ideas.
    </p>
    <div className="font-thin text-xs text-center ">
      <img src="qart_mike.png" alt="mike wazowski qart code"/>
      Created using <Sa href="https://research.swtch.com/qr/draw">QArt Coder</Sa>
    </div>
    <div className="font-thin text-xs text-center ">
      <img src="micro_mike.png" alt="mike wazowski micrography qr"/>
      Example from <Sa href="https://cgv.cs.nthu.edu.tw/projects/Recreational_Graphics/MQRC">Micrography QR Codes</Sa>
    </div>
  </div>
}

[^1]: [Lachlan Arthur](https://github.com/lachlanarthur)'s [original JSFiddle implementaion](https://jsfiddle.net/lachlan/r8qWV/) 

    [Jason Butler](https://github.com/nythrox)'s [Halftone QR Code Generator](https://github.com/nythrox/halftone-qrcode)

    [Roman Tsukanov](https://github.com/gentlecat)'s [Halftone QR Code Generator](https://qr.roman.zone).


[vCode](https://github.com/ruitaocc/vCode)


[QRpicture](https://github.com/xyzzy/qrpicture)


{
  <div className="grid cols-2 font-thin text-xs text-center">
    <div>
      <img src="qrpicture.gif" alt="animated qr picture"/>
      Example from <Sa>https://github.com/xyzzy/qrpicture</Sa>
    </div>

  </div>
}

## Tangents

Tangent -> Creating QR code that matches a string
https://marienraat.nl/hacking-qr-codes.html
There's a 100 page PDF describing the QR code standard (ISO/IEC 18004) in detail, but here's the truth.

A QR code is whatever a QR code scanner can scan.

Here are some undocumented behaviors I discovered while making [a simple QR code generator](https://github.com/fuqr).

- UTF-8 is implicitly supported when using the byte encoding mode.
- Kanji, Structured append, EC1, and FNC1 encoding modes aren't relevant for normal use. Scanners might not even support them (I can't find generators that support them either).


I found this book in a random library I stopped in. Too much of the QR code was missing for it to scan, but I thought it might contain an Easter egg. I used [QRazyBox](https://merri.cx/qrazybox/) to recover what data remained which was only about half the URL. This was the first strange finding. The code was almost entirely padding! The error correction was set to low too! Why wasn't the error correction set higher if the space was all wasted? 

![qr code on book cover](sf_book.jpg)

Using an ASCII chart to decode some partially obscured bytes, I figured out it pointed to an iStockphoto page, but unfortunately iStockphoto had changed their URL structure. I had what looked like half a username, but there was no way to search for users. With no other option, I brute-forced all 80,000 possible QR codes and compared the error correction pixels to find a match. I was shocked to find nothing. In a desperate last try, I checked for near matches and finally found the matching username which led me to the [original stock image from 2011](https://www.istockphoto.com/vector/qr-code-gm156283521-15512938).

It turns out the QR code incorrectly has a last byte filled with 1s instead of 0s.

Why was this used for the book cover? The book came out in 2021. Did the designer just have it on hand? Even though they could just get a QR code from anywhere? I guess it didn't matter, because who would notice? Kind of an anticlimax, but my takeaway is that damaged QR codes are probably all decodable with effort.

[^1]: My reference.

Some companies have even gone so far as to develop proprietary scannable codes to maintain their brand identity, to varying success[^scannable-codes].

[^scannable-codes]: Tiktok and Snapchat have already replaced their custom codes with stylized QR codes.

![four proprietary scan codes](four_horsemen.png)

Notice how they're all mostly gimmicks since they can only be scanned with a specific app (or device).